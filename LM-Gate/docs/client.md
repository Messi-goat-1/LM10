1. هيكل البيانات ChunkMessage
هذا هو "القالب" الذي تُوضع فيه البيانات قبل إرسالها. يحتوي على:

FileID: معرف فريد للملف.

ChunkID: رقم الجزء الحالي (لضمان الترتيب).

Total: العدد الإجمالي للأجزاء.

Data: محتوى الجزء نفسه كمصفوفة بايتات.

IsEOF: علامة تخبر السيرفر: "هذا آخر شيء، لقد انتهى الملف".

2. دالة البداية rootCmd
تستخدم مكتبة cobra لإنشاء واجهة سطر أوامر (CLI):

تطلب من المستخدم إدخال مسار الملف (مثلاً: LM test.pcap).

تحدد حجم الجزء الواحد بـ 5 ميجابايت.

تستدعي دالة UploadFile لبدء العملية.

3. دالة SplitFile (التقسيم)
هي دالة تقنية تعمل في الخلفية (Goroutine):

تفتح الملف وتقرأه قطعة قطعة بحجم chunkSize.

تستخدم "Channels" (قنوات) لإرسال القطع فور قراءتها لتوفير الوقت.

تستمر في القراءة حتى تصل لنهاية الملف (io.EOF).

4. دالة GenerateFileID
تنشئ اسماً فريداً للملف يجمع بين اسم الملف الأصلي وحجمه. هذا يساعد السيرفر على معرفة أن هذه الأجزاء تنتمي لنفس الملف.

5. دالة UploadFile (المايسترو)
هي التي تدير العملية بالكامل:

تولد معرف الملف.

تقسم الملف باستخدام SplitFile.

تمر عبر كل الأجزاء وترسلها واحداً تلو الآخر باستخدام BuildChunkMessage.

في النهاية، ترسل إشارة النهاية عبر دالة SendEOF.

6. دالة BuildChunkMessage و SendEOF
BuildChunkMessage: تضع البيانات في هيكل الرسالة وتحدد رقم الجزء.

SendEOF: تنشئ رسالة فارغة لكنها تحمل علامة IsEOF = true لإعلام الطرف الآخر بالاكتمال.

كيف يعمل النظام بالكامل (الربط بين الملفات الثلاثة):
العميل (client.go): يأخذ ملف PCAP، يقسمه لقطع 5MB، ويرسلها.

الوسيط (rabbit.go): (في حال استخدامه كـ Sender) يأخذ هذه القطع ويضعها في طابور RabbitMQ.

السيرفر (server.go): يستقبل القطع من الطابور، يخزنها في مجلد مؤقت، وعند وصول رسالة IsEOF يقوم بتجميعها وتحليلها.