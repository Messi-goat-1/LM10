
ملخص سير العمل
:rebbit.go
1. الهيكل RabbitClient
هذا الهيكل يمثل "العميل" الذي سيتعامل مع RabbitMQ.

conn: يمثل الاتصال الفعلي (TCP Connection) مع الخادم.

channel: القناة التي يتم عبرها إرسال واستقبال البيانات (القنوات أخف من الاتصالات الكاملة).

2. دالة NewRabbitClient
هذه هي دالة الإنشاء (Constructor):

تأخذ عنوان السيرفر (url) وتقوم بفتح اتصال.

تفتح قناة اتصال داخل هذا الرابط.

تعيد كائن RabbitClient جاهز للاستخدام.

3. دالة Close
دالة التنظيف:

تضمن إغلاق القناة والاتصال بشكل آمن عند انتهاء الحاجة للسيرفر، لمنع تسريب الموارد (Memory/Connection leaks).

4. دالة PublishMessage
مهمتها "إرسال" الرسائل:

تتأكد أولاً من وجود الطابور (QueueDeclare)؛ فإذا لم يكن موجوداً تقوم بإنشائه.

ترسل الرسالة النصية إلى الطابور المحدد باستخدام PublishWithContext.

5. دالة RunHeartbeat
دالة مراقبة (نبضات القلب):

تعمل بشكل آلي كل دقيقة واحدة (1 * time.Minute).

ترسل رسالة نصية لطابور يسمى server_status تخبر فيه النظام أن "السيرفر لا يزال يعمل" مع ذكر الوقت.

تفيد هذه الدالة في مراقبة حالة السيرفر عن بُعد.

6. دالة ConsumeMessages
مهمتها "استقبال" الرسائل:

تفتح باب الاستماع على طابور معين (queueName).

تستخدم "Goroutine" (دالة تعمل في الخلفية) لكي لا يتوقف البرنامج أثناء انتظار الرسائل.

عند وصول أي رسالة، تقوم بتمرير محتواها (d.Body) إلى دالة معالجة (processor) تقوم أنت بتعريفها لاحقاً.
الاتصال: ننشئ العميل بـ NewRabbitClient.

الإرسال: نستخدم PublishMessage لإرسال بيانات.

المراقبة: RunHeartbeat تعمل في الخلفية لتأكيد أن السيرفر متصل.

الاستقبال: ConsumeMessages تنتظر أي رسائل قادمة من أنظمة أخرى لتعالجها.