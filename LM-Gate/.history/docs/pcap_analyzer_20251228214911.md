GetFileHandle(filePath): وظيفتها تقنية بحتة، حيث تقوم بفتح الملف المسجل على القرص (Offline) وتجهيزه للقراءة باستخدام مكتبة pcap.

RunFullAnalysis(handle): هي محرك الفحص:

تقوم بقراءة الحزم (Packets) واحدة تلو الأخرى.

تستخرج تفاصيل كل حزمة (مثل عناوين IP، والمنافذ Ports، والبيانات المرسلة).

في هذا الكود، تمت برمجتها لطباعة أول حزمتين فقط كاختبار للهيكل.

AnalyzePCAP(fileID, filePath): هي الدالة الرابطة التي يستدعيها السيرفر. هي من ينظم العمل عبر استدعاء دالة الفتح أولاً ثم دالة التحليل الشامل.